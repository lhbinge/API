"ah_code0","ah_code1","sculpt0","sculpt1","sign0","sign1","date0","date1",
"nr0","nr1")
repeatsales <- repsale(fullrep$price0,fullrep$time0,fullrep$price1,fullrep$time1,mergefirst=2,
graph=TRUE,graph.conf=TRUE,conf=.95)
sps.RS_index <- exp(as.data.frame(repeatsales$pindex))*100
dy <- fullrep$price1 - fullrep$price0
timevar <- levels(factor(c(fullrep$time0, fullrep$time1)))
nt = length(timevar)
n = length(dy)
xmat <- array(0, dim = c(n, nt - 1))
for (j in seq(1 + 1, nt)) {
xmat[, j - 1] <- ifelse(fullrep$time1 == timevar[j], 1, xmat[, j - 1])
xmat[, j - 1] <- ifelse(fullrep$time0 == timevar[j],-1, xmat[, j - 1])
}
colnames(xmat) <- paste("Time", seq(1 + 1, nt))
fit <- lm(dy ~ xmat + 0)
fullrep$med_code0[is.na(fullrep$med_code0)] <- "Oil"
fullrep$med_code1[is.na(fullrep$med_code1)] <- "Oil"
fullrep$ah_code0[is.na(fullrep$ah_code0)] <- "Strauss"
fullrep$ah_code1[is.na(fullrep$ah_code1)] <- "Strauss"
darea <- fullrep$area1 - fullrep$area0
med0 <- model.matrix(~fullrep$med_code0)
med1 <- model.matrix(~fullrep$med_code1)
dmed <- med1 - med0
ah0 <- model.matrix(~fullrep$ah_code0)
ah1 <- model.matrix(~fullrep$ah_code1)
dah <- ah1 - ah0
dsculpt <- fullrep$sculpt1 - fullrep$sculpt0
dnr <- fullrep$nr1 - fullrep$nr0
sign0 <- model.matrix(~fullrep$sign0)
sign1 <- model.matrix(~fullrep$sign1)
dsign <- sign1 - sign0
date0 <- model.matrix(~fullrep$date0)
date1 <- model.matrix(~fullrep$date1)
ddate <- date1 - date0
#ps.RS <- lm(dy ~ darea + dmed + dah + dsculpt + dnr + dsign + ddate + xmat + 0)
ps.RS <- lm(dy ~ darea + dah + dsculpt + dnr + dsign + ddate + xmat + 0)
ps.RS_results <- summary(ps.RS)$coefficients[grepl("Time", rownames(summary(ps.RS)$coefficients)),1]
ps.RS_results <- as.data.frame(ps.RS_results)
ps.RS_results$index_all <- exp(ps.RS_results$ps.RS_results)*100
index_plot <- time_results
index_plot$Date <- c("2000Q2","2000Q3","2000Q4","2001Q1","2001Q2","2001Q3","2001Q4","2002Q1","2002Q2","2002Q3","2002Q4",
"2003Q1","2003Q2","2003Q3","2003Q4","2004Q1","2004Q2","2004Q3","2004Q4","2005Q1","2005Q2","2005Q3","2005Q4",
"2006Q1","2006Q2","2006Q3","2006Q4","2007Q1","2007Q2","2007Q3","2007Q4","2008Q1","2008Q2","2008Q3","2008Q4",
"2009Q1","2009Q2","2009Q3","2009Q4","2010Q1","2010Q2","2010Q3","2010Q4","2011Q1","2011Q2","2011Q3","2011Q4",
"2012Q1","2012Q2","2012Q3","2012Q4","2013Q1","2013Q2","2013Q3","2013Q4","2014Q1","2014Q2","2014Q3","2014Q4",
"2015Q1","2015Q2")
repeatsales_index$Date <- c("2000Q4","2001Q1","2001Q2","2001Q3","2001Q4","2002Q1","2002Q2","2002Q4",
"2003Q1","2003Q2","2003Q4","2004Q1","2004Q2","2004Q4","2005Q1","2005Q2","2005Q3","2005Q4",
"2006Q1","2006Q2","2006Q3","2006Q4","2007Q2","2007Q3","2007Q4","2008Q1","2008Q2","2008Q3","2008Q4",
"2009Q1","2009Q2","2009Q3","2009Q4","2010Q1","2010Q2","2010Q3","2010Q4","2011Q1","2011Q2","2011Q3","2011Q4",
"2012Q1","2012Q2","2012Q3","2012Q4","2013Q1","2013Q2","2013Q3","2013Q4","2014Q1","2014Q2","2014Q3","2014Q4",
"2015Q1","2015Q2")
index_plot <- merge(index_plot, repeatsales_index, by="Date", all=TRUE)
#index_plot <- cbind(index_plot,Simple_ps.RS=sps.RS_index[2:62,1])
index_plot <- cbind(index_plot,Full_ps.RS=ps.RS_results[,2])
index_plot <- index_plot[,c(-2,-3,-4)]
#index_plot <- cbind(index_plot,RepIndex_Full=rep_results[,2])
index_plot <- cbind(index_plot,RepOverlap_1y=rep_overlap1[,19])
index_plot <- cbind(index_plot,RepOverlap_2y=rep_overlap2[,11])
#index_plot <- cbind(index_plot,RepRolling=rep_rolling[,15])
#png(file = "Repeat Sales.png", width=600,height=360)
index_plot <- melt(index_plot, id="Date")  # convert to long format
g <- ggplot(data=index_plot,aes(x=Date, y=value, group=variable, colour=variable))
g <- g + geom_point(size = 3)
g <- g + geom_line()
g <- g + ylab("Index")
g <- g + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.position="bottom") + theme(legend.title=element_blank())
g
View(rep_results)
View(fullrep)
teller <-0
repdata <- data.frame()
rartdata <- subset(artdata,artdata$rank_all<max(artdata$rank_all,na.rm=TRUE))
keep <- c("lnprice","artist","title","lnarea","ah_code","med_code","lnsculpt_area","dum_signed","dum_dated",
"nr_works","timedummy","counter")
rartdata <- rartdata[,names(rartdata) %in% keep]
rartdata <- rartdata[complete.cases(rartdata),]
## Rank total again for new sample
rankings <- count(rartdata, artist)
rankings$rank_total <- row_number(desc(rankings$n))
rartdata <- merge(rartdata, rankings, by.x="artist", by.y="artist",all.x=TRUE)
for(k in 1:max(rartdata$rank_total)) { #max(rartdata$rank_total)
modeldata <- subset(rartdata, rartdata$rank_total==k)
modeldata$med_code <- factor(modeldata$med_code)
modeldata$ah_code <- factor(modeldata$ah_code)
modeldata$dum_signed <- factor(modeldata$dum_signed)
modeldata$dum_dated <- factor(modeldata$dum_dated)
modeldata$timedummy <- factor(modeldata$timedummy)
#modeldata <- cbind(modeldata,model.matrix(~modeldata$med_code))
if(length(levels(modeldata$med_code))==1)   { modeldata$med_code <- as.numeric(0) }
if(length(levels(modeldata$ah_code))==1)    { modeldata$ah_code <- as.numeric(0) }
if(length(levels(modeldata$dum_signed))==1) { modeldata$dum_signed <- as.numeric(0) }
if(length(levels(modeldata$dum_dated))==1)  { modeldata$dum_dated <- as.numeric(0)   }
if(length(levels(modeldata$timedummy))!=1) { #modeldata$timedummy <- as.numeric(0)
model <- lm(expl_vars, data=modeldata, na.action = na.exclude)
newdata <- modeldata
newdata$timedummy <- newdata$timedummy[1]
modeldata <- cbind(modeldata,fitted=predict.lm(model,newdata=newdata))
modeldata$id <- 0
for(i in 1:nrow(modeldata)) {
teller <- teller + 1
if(modeldata$id[i]==0) {
modeldata$id[i] <- teller
medium <- modeldata$med_code[i]
modeldata$distance <- abs(modeldata$fitted[i]-modeldata$fitted)/modeldata$fitted[i]
modeldata$id[(modeldata$distance<0.00005 & modeldata[,"id"]==0 & modeldata[,"med_code"]==medium)] <- teller
#modeldata$id[(modeldata$distance==min(modeldata[modeldata[,"id"]==0 & modeldata[,"med_code"]==medium ,"distance"],na.rm=TRUE))] <- teller
}
}
repdata <- rbind(repdata,modeldata)
}
}
fullrep <- cbind(repsaledata(repdata$lnprice,repdata$counter,repdata$id),
repsaledata(repdata$lnarea,repdata$counter,repdata$id)[,4:5],
repsaledata(repdata$med_code,repdata$counter,repdata$id)[,4:5],
repsaledata(repdata$ah_code,repdata$counter,repdata$id)[,4:5],
repsaledata(repdata$lnsculpt_area,repdata$counter,repdata$id)[,4:5],
repsaledata(repdata$dum_signed,repdata$counter,repdata$id)[,4:5],
repsaledata(repdata$dum_dated,repdata$counter,repdata$id)[,4:5],
repsaledata(repdata$nr_works,repdata$counter,repdata$id)[,4:5])
colnames(fullrep) <- c("id","time0","time1","price0","price1","area0","area1","med_code0","med_code1",
"ah_code0","ah_code1","sculpt0","sculpt1","sign0","sign1","date0","date1",
"nr0","nr1")
repeatsales <- repsale(fullrep$price0,fullrep$time0,fullrep$price1,fullrep$time1,mergefirst=2,
graph=TRUE,graph.conf=TRUE,conf=.95)
sps.RS_index <- exp(as.data.frame(repeatsales$pindex))*100
dy <- fullrep$price1 - fullrep$price0
timevar <- levels(factor(c(fullrep$time0, fullrep$time1)))
nt = length(timevar)
n = length(dy)
xmat <- array(0, dim = c(n, nt - 1))
for (j in seq(1 + 1, nt)) {
xmat[, j - 1] <- ifelse(fullrep$time1 == timevar[j], 1, xmat[, j - 1])
xmat[, j - 1] <- ifelse(fullrep$time0 == timevar[j],-1, xmat[, j - 1])
}
colnames(xmat) <- paste("Time", seq(1 + 1, nt))
fit <- lm(dy ~ xmat + 0)
fullrep$med_code0[is.na(fullrep$med_code0)] <- "Oil"
fullrep$med_code1[is.na(fullrep$med_code1)] <- "Oil"
fullrep$ah_code0[is.na(fullrep$ah_code0)] <- "Strauss"
fullrep$ah_code1[is.na(fullrep$ah_code1)] <- "Strauss"
darea <- fullrep$area1 - fullrep$area0
med0 <- model.matrix(~fullrep$med_code0)
med1 <- model.matrix(~fullrep$med_code1)
dmed <- med1 - med0
ah0 <- model.matrix(~fullrep$ah_code0)
ah1 <- model.matrix(~fullrep$ah_code1)
dah <- ah1 - ah0
dsculpt <- fullrep$sculpt1 - fullrep$sculpt0
dnr <- fullrep$nr1 - fullrep$nr0
sign0 <- model.matrix(~fullrep$sign0)
sign1 <- model.matrix(~fullrep$sign1)
dsign <- sign1 - sign0
date0 <- model.matrix(~fullrep$date0)
date1 <- model.matrix(~fullrep$date1)
ddate <- date1 - date0
#ps.RS <- lm(dy ~ darea + dmed + dah + dsculpt + dnr + dsign + ddate + xmat + 0)
ps.RS <- lm(dy ~ darea + dah + dsculpt + dnr + dsign + ddate + xmat + 0)
ps.RS_results <- summary(ps.RS)$coefficients[grepl("Time", rownames(summary(ps.RS)$coefficients)),1]
ps.RS_results <- as.data.frame(ps.RS_results)
ps.RS_results$index_all <- exp(ps.RS_results$ps.RS_results)*100
index_plot <- time_results
index_plot$Date <- c("2000Q2","2000Q3","2000Q4","2001Q1","2001Q2","2001Q3","2001Q4","2002Q1","2002Q2","2002Q3","2002Q4",
"2003Q1","2003Q2","2003Q3","2003Q4","2004Q1","2004Q2","2004Q3","2004Q4","2005Q1","2005Q2","2005Q3","2005Q4",
"2006Q1","2006Q2","2006Q3","2006Q4","2007Q1","2007Q2","2007Q3","2007Q4","2008Q1","2008Q2","2008Q3","2008Q4",
"2009Q1","2009Q2","2009Q3","2009Q4","2010Q1","2010Q2","2010Q3","2010Q4","2011Q1","2011Q2","2011Q3","2011Q4",
"2012Q1","2012Q2","2012Q3","2012Q4","2013Q1","2013Q2","2013Q3","2013Q4","2014Q1","2014Q2","2014Q3","2014Q4",
"2015Q1","2015Q2")
repeatsales_index$Date <- c("2000Q4","2001Q1","2001Q2","2001Q3","2001Q4","2002Q1","2002Q2","2002Q4",
"2003Q1","2003Q2","2003Q4","2004Q1","2004Q2","2004Q4","2005Q1","2005Q2","2005Q3","2005Q4",
"2006Q1","2006Q2","2006Q3","2006Q4","2007Q2","2007Q3","2007Q4","2008Q1","2008Q2","2008Q3","2008Q4",
"2009Q1","2009Q2","2009Q3","2009Q4","2010Q1","2010Q2","2010Q3","2010Q4","2011Q1","2011Q2","2011Q3","2011Q4",
"2012Q1","2012Q2","2012Q3","2012Q4","2013Q1","2013Q2","2013Q3","2013Q4","2014Q1","2014Q2","2014Q3","2014Q4",
"2015Q1","2015Q2")
index_plot <- merge(index_plot, repeatsales_index, by="Date", all=TRUE)
#index_plot <- cbind(index_plot,Simple_ps.RS=sps.RS_index[2:62,1])
index_plot <- cbind(index_plot,Full_ps.RS=ps.RS_results[,2])
index_plot <- index_plot[,c(-2,-3,-4)]
#index_plot <- cbind(index_plot,RepIndex_Full=rep_results[,2])
index_plot <- cbind(index_plot,RepOverlap_1y=rep_overlap1[,19])
index_plot <- cbind(index_plot,RepOverlap_2y=rep_overlap2[,11])
#index_plot <- cbind(index_plot,RepRolling=rep_rolling[,15])
#png(file = "Repeat Sales.png", width=600,height=360)
index_plot <- melt(index_plot, id="Date")  # convert to long format
g <- ggplot(data=index_plot,aes(x=Date, y=value, group=variable, colour=variable))
g <- g + geom_point(size = 3)
g <- g + geom_line()
g <- g + ylab("Index")
g <- g + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.position="bottom") + theme(legend.title=element_blank())
g
index_plot <- time_results
index_plot$Date <- c("2000Q2","2000Q3","2000Q4","2001Q1","2001Q2","2001Q3","2001Q4","2002Q1","2002Q2","2002Q3","2002Q4",
"2003Q1","2003Q2","2003Q3","2003Q4","2004Q1","2004Q2","2004Q3","2004Q4","2005Q1","2005Q2","2005Q3","2005Q4",
"2006Q1","2006Q2","2006Q3","2006Q4","2007Q1","2007Q2","2007Q3","2007Q4","2008Q1","2008Q2","2008Q3","2008Q4",
"2009Q1","2009Q2","2009Q3","2009Q4","2010Q1","2010Q2","2010Q3","2010Q4","2011Q1","2011Q2","2011Q3","2011Q4",
"2012Q1","2012Q2","2012Q3","2012Q4","2013Q1","2013Q2","2013Q3","2013Q4","2014Q1","2014Q2","2014Q3","2014Q4",
"2015Q1","2015Q2")
repeatsales_index$Date <- c("2000Q4","2001Q1","2001Q2","2001Q3","2001Q4","2002Q1","2002Q2","2002Q4",
"2003Q1","2003Q2","2003Q4","2004Q1","2004Q2","2004Q4","2005Q1","2005Q2","2005Q3","2005Q4",
"2006Q1","2006Q2","2006Q3","2006Q4","2007Q2","2007Q3","2007Q4","2008Q1","2008Q2","2008Q3","2008Q4",
"2009Q1","2009Q2","2009Q3","2009Q4","2010Q1","2010Q2","2010Q3","2010Q4","2011Q1","2011Q2","2011Q3","2011Q4",
"2012Q1","2012Q2","2012Q3","2012Q4","2013Q1","2013Q2","2013Q3","2013Q4","2014Q1","2014Q2","2014Q3","2014Q4",
"2015Q1","2015Q2")
index_plot <- merge(index_plot, repeatsales_index, by="Date", all=TRUE)
index_plot <- cbind(index_plot,Simple_ps.RS=sps.RS_index[2:62,1])
index_plot <- cbind(index_plot,Full_ps.RS=ps.RS_results[,2])
all_indices <- time_results
all_indices$Date <- c("2000Q2","2000Q3","2000Q4","2001Q1","2001Q2","2001Q3","2001Q4","2002Q1","2002Q2","2002Q3","2002Q4",
"2003Q1","2003Q2","2003Q3","2003Q4","2004Q1","2004Q2","2004Q3","2004Q4","2005Q1","2005Q2","2005Q3","2005Q4",
"2006Q1","2006Q2","2006Q3","2006Q4","2007Q1","2007Q2","2007Q3","2007Q4","2008Q1","2008Q2","2008Q3","2008Q4",
"2009Q1","2009Q2","2009Q3","2009Q4","2010Q1","2010Q2","2010Q3","2010Q4","2011Q1","2011Q2","2011Q3","2011Q4",
"2012Q1","2012Q2","2012Q3","2012Q4","2013Q1","2013Q2","2013Q3","2013Q4","2014Q1","2014Q2","2014Q3","2014Q4",
"2015Q1","2015Q2")
repeatsales_index$Date <- c("2000Q4","2001Q1","2001Q2","2001Q3","2001Q4","2002Q1","2002Q2","2002Q4",
"2003Q1","2003Q2","2003Q4","2004Q1","2004Q2","2004Q4","2005Q1","2005Q2","2005Q3","2005Q4",
"2006Q1","2006Q2","2006Q3","2006Q4","2007Q2","2007Q3","2007Q4","2008Q1","2008Q2","2008Q3","2008Q4",
"2009Q1","2009Q2","2009Q3","2009Q4","2010Q1","2010Q2","2010Q3","2010Q4","2011Q1","2011Q2","2011Q3","2011Q4",
"2012Q1","2012Q2","2012Q3","2012Q4","2013Q1","2013Q2","2013Q3","2013Q4","2014Q1","2014Q2","2014Q3","2014Q4",
"2015Q1","2015Q2")
all_indices <- merge(all_indices, repeatsales_index, by="Date", all=TRUE)
all_indices <- cbind(all_indices,Simple_ps.RS=sps.RS_index[2:62,1])
all_indices <- cbind(all_indices,Full_ps.RS=ps.RS_results[,2])
View(all_indices)
all_indices <- all_indices[,c(-2)]
all_indices <- cbind(all_indices,RepIndex_Full=rep_results[,2])
all_indices <- cbind(all_indices,RepOverlap_1y=rep_overlap1[,19])
all_indices <- cbind(all_indices,RepOverlap_2y=rep_overlap2[,11])
all_indices <- cbind(all_indices,RepRolling=rep_rolling[,15])
index_plot <- melt(all_indices, id="Date")  # convert to long format
g <- ggplot(data=index_plot,aes(x=Date, y=value, group=variable, colour=variable))
g <- g + geom_point(size = 3)
g <- g + geom_line()
g <- g + ylab("Index")
g <- g + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.position="bottom") + theme(legend.title=element_blank())
g
index_plot <- melt(all_indices, id="Date")  # convert to long format
g <- ggplot(data=index_plot,aes(x=Date, y=value, group=variable, colour=variable))
g <- g + geom_point(size = 3)
g <- g + geom_line()
g <- g + ylab("Index")
g <- g + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.title=element_blank()) #theme(legend.position="bottom") +
g
cor(all_indices)
cor(all_indices[,-1])
?cor
cor(all_indices[,-1],na.rm=TRUE)
cor(all_indices[,c(-1,-3)],na.rm=TRUE)
cor(all_indices[,c(-1,-3)])
std.dev <- sd(all_indices)
sd(all_indices[,c(-1)])
?apply
apply(all_indices[,c(-1)], sd)
apply(all_indices[,c(-1)], FUN=sd)
apply(all_indices[,c(-1)],MARGIN=2, FUN=sd)
apply(all_indices[,c(-1)],MARGIN=2, FUN=sd, na.rm=TRUE)
apply(all_indices[,c(-1)],MARGIN=2, FUN=var, na.rm=TRUE)
ts_indices <- ts(all_indices[,-1],start=c(2000,2),end=c(2015,2),frequency=4)
apply(all_indices[,c(-1)],MARGIN=2, FUN=ac, na.rm=TRUE)
?ac
apply(all_indices[,c(-1)],MARGIN=2, FUN=acf, na.rm=TRUE)
acf(all_indices[,2])
acf(all_indices[,2],lag.max = 1,plot = FALSE)
acf(all_indices[,2],lag.max = 1,plot = FALSE)[2,]
acf(all_indices[,2],lag.max = 1,plot = FALSE)[,2]
?acf
acf(all_indices[,2],lag.max = 1,plot = FALSE)[1,]
for(c in 2:ncol(all_indices)) {
acf(all_indices[,i],lag.max = 1,plot = FALSE)[1,]
}
apply(all_indices[,c(-1)],MARGIN=2, FUN=acf(all_indices[,i],lag.max = 1,plot = FALSE)[1,], na.rm=TRUE)
ac.1 <- function(x) {
acf(x,lag.max = 1,plot = FALSE)[1,]
}
apply(all_indices[,c(-1)],MARGIN=2, FUN=var, na.rm=TRUE)
apply(all_indices[,c(-1)],MARGIN=2, FUN=ac.1, na.rm=TRUE)
apply(all_indices[,c(-1)],MARGIN=2, FUN=ac.1)
ac.1 <- function(x) {
acf(x,lag.max = 1,plot = FALSE,na.action = na.pass)[1,]
}
apply(all_indices[,c(-1)],MARGIN=2, FUN=ac.1)
?sapply
sapply(all_indices[,c(-1)],MARGIN=2, FUN=ac.1)
sapply(all_indices[,c(-1)], FUN=ac.1)
sapply(all_indices[,c(-1)], FUN=ac.1)[1,]
mapply(all_indices[,c(-1)],MARGIN=2, FUN=ac.1)
mapply(all_indices[,c(-1)], FUN=ac.1)
ac1 <- sapply(all_indices[,c(-1)], FUN=ac.1)
View(ac1)
ac1 <- sapply(all_indices[,c(-1)], FUN=ac.1)[1,]
eval <- sapply(all_indices[,c(-1)], FUN=ac.1)[1,]
eval <- cbind(eval,apply(all_indices[,c(-1)],MARGIN=2, FUN=sd, na.rm=TRUE))
View(eval)
eval <- cbind(eval,apply(all_indices[,c(-1)],MARGIN=2, FUN=var, na.rm=TRUE))
all_indices <- rbind(c("2000Q1", 100,100,100,100,100,100,100,100),all_indices)
cor(all_indices[,c(-1,-3)])
str(all_indices)
all_indices[,2:9] <- as.numeric(all_indices[,2:9])
ac.1 <- function(x) {
acf(x,lag.max = 1,plot = FALSE,na.action = na.pass)[1,]
}
eval <- sapply(all_indices[,c(-1)], FUN=ac.1)[1,]
eval <- cbind(eval,apply(all_indices[,c(-1)],MARGIN=2, FUN=sd, na.rm=TRUE))
all_indices <- time_results
all_indices$Date <- c("2000Q2","2000Q3","2000Q4","2001Q1","2001Q2","2001Q3","2001Q4","2002Q1","2002Q2","2002Q3","2002Q4",
"2003Q1","2003Q2","2003Q3","2003Q4","2004Q1","2004Q2","2004Q3","2004Q4","2005Q1","2005Q2","2005Q3","2005Q4",
"2006Q1","2006Q2","2006Q3","2006Q4","2007Q1","2007Q2","2007Q3","2007Q4","2008Q1","2008Q2","2008Q3","2008Q4",
"2009Q1","2009Q2","2009Q3","2009Q4","2010Q1","2010Q2","2010Q3","2010Q4","2011Q1","2011Q2","2011Q3","2011Q4",
"2012Q1","2012Q2","2012Q3","2012Q4","2013Q1","2013Q2","2013Q3","2013Q4","2014Q1","2014Q2","2014Q3","2014Q4",
"2015Q1","2015Q2")
repeatsales_index$Date <- c("2000Q4","2001Q1","2001Q2","2001Q3","2001Q4","2002Q1","2002Q2","2002Q4",
"2003Q1","2003Q2","2003Q4","2004Q1","2004Q2","2004Q4","2005Q1","2005Q2","2005Q3","2005Q4",
"2006Q1","2006Q2","2006Q3","2006Q4","2007Q2","2007Q3","2007Q4","2008Q1","2008Q2","2008Q3","2008Q4",
"2009Q1","2009Q2","2009Q3","2009Q4","2010Q1","2010Q2","2010Q3","2010Q4","2011Q1","2011Q2","2011Q3","2011Q4",
"2012Q1","2012Q2","2012Q3","2012Q4","2013Q1","2013Q2","2013Q3","2013Q4","2014Q1","2014Q2","2014Q3","2014Q4",
"2015Q1","2015Q2")
all_indices <- merge(all_indices, repeatsales_index, by="Date", all=TRUE)
all_indices <- cbind(all_indices,Simple_ps.RS=sps.RS_index[2:62,1])
all_indices <- cbind(all_indices,Full_ps.RS=ps.RS_results[,2])
all_indices <- all_indices[,c(-2)]
all_indices <- cbind(all_indices,RepIndex_Full=rep_results[,2])
all_indices <- cbind(all_indices,RepOverlap_1y=rep_overlap1[,19])
all_indices <- cbind(all_indices,RepOverlap_2y=rep_overlap2[,11])
all_indices <- cbind(all_indices,RepRolling=rep_rolling[,15])
all_indices <- time_results
all_indices$Date <- c("2000Q2","2000Q3","2000Q4","2001Q1","2001Q2","2001Q3","2001Q4","2002Q1","2002Q2","2002Q3","2002Q4",
"2003Q1","2003Q2","2003Q3","2003Q4","2004Q1","2004Q2","2004Q3","2004Q4","2005Q1","2005Q2","2005Q3","2005Q4",
"2006Q1","2006Q2","2006Q3","2006Q4","2007Q1","2007Q2","2007Q3","2007Q4","2008Q1","2008Q2","2008Q3","2008Q4",
"2009Q1","2009Q2","2009Q3","2009Q4","2010Q1","2010Q2","2010Q3","2010Q4","2011Q1","2011Q2","2011Q3","2011Q4",
"2012Q1","2012Q2","2012Q3","2012Q4","2013Q1","2013Q2","2013Q3","2013Q4","2014Q1","2014Q2","2014Q3","2014Q4",
"2015Q1","2015Q2")
repeatsales_index$Date <- c("2000Q4","2001Q1","2001Q2","2001Q3","2001Q4","2002Q1","2002Q2","2002Q4",
"2003Q1","2003Q2","2003Q4","2004Q1","2004Q2","2004Q4","2005Q1","2005Q2","2005Q3","2005Q4",
"2006Q1","2006Q2","2006Q3","2006Q4","2007Q2","2007Q3","2007Q4","2008Q1","2008Q2","2008Q3","2008Q4",
"2009Q1","2009Q2","2009Q3","2009Q4","2010Q1","2010Q2","2010Q3","2010Q4","2011Q1","2011Q2","2011Q3","2011Q4",
"2012Q1","2012Q2","2012Q3","2012Q4","2013Q1","2013Q2","2013Q3","2013Q4","2014Q1","2014Q2","2014Q3","2014Q4",
"2015Q1","2015Q2")
all_indices <- merge(all_indices, repeatsales_index, by="Date", all=TRUE)
all_indices <- cbind(all_indices,Simple_ps.RS=sps.RS_index[2:62,1])
all_indices <- cbind(all_indices,Full_ps.RS=ps.RS_results[,2])
all_indices <- all_indices[,c(-2)]
all_indices <- cbind(all_indices,RepIndex_Full=rep_results[,2])
all_indices <- cbind(all_indices,RepOverlap_1y=rep_overlap1[,19])
all_indices <- cbind(all_indices,RepOverlap_2y=rep_overlap2[,11])
all_indices <- cbind(all_indices,RepRolling=rep_rolling[,15])
ts_indices <- ts(all_indices[,-1],start=c(2000,2),end=c(2015,2),frequency=4)
?rbind
ts.all_indices <- rbind(all_indices,c("2000Q1", 100,100,100,100,100,100,100,100))
View(ts.all_indices)
str(ts.all_indices)
cor(all_indices[,c(-1,-3)])
ac.1 <- function(x) {
acf(x,lag.max = 1,plot = FALSE,na.action = na.pass)[1,]
}
eval <- sapply(all_indices[,c(-1)], FUN=ac.1)[1,]
eval <- cbind(eval,apply(all_indices[,c(-1)],MARGIN=2, FUN=sd, na.rm=TRUE))
ts.all_indices <- ts.all_indices[c(62,1:61],)
ts.all_indices <- ts.all_indices[c(62,1:61),])
ts.all_indices <- ts.all_indices[c(62,1:61),]
index_plot <- melt(ts.all_indices, id="Date")  # convert to long format
g <- ggplot(data=index_plot,aes(x=Date, y=value, group=variable, colour=variable))
g <- g + geom_point(size = 3)
g <- g + geom_line()
g <- g + ylab("Index")
g <- g + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.title=element_blank()) #theme(legend.position="bottom") +
g
cor(ts.all_indices[,c(-1,-3)])
ts.all_indices <- rbind(c("2000Q1", as.numeric(100,100,100,100,100,100,100,100)),all_indices)
str(ts.all_indices)
ts.all_indices <- rbind(c("2000Q1", 100,100,100,100,100,100,100,100),all_indices)
ts.all_indices <- cbind(ts.all_indices[,1],as.numeric(ts.all_indices))
ts.all_indices <- rbind(c(100,100,100,100,100,100,100,100),all_indices[,-1])
str(ts.all_indices)
ts.all_indices <- ts(ts.all_indices,start =c(2000,1),end=c(2015,2),frequency=4 )
cor(ts.all_indices)
cor(ts.all_indices,na.rm=TRUE)
cor(ts.all_indices,na.action = na.pass)
?cor
cor(ts.all_indices, use ="complete.obs")
ac.1 <- function(x) {
acf(x,lag.max = 1,plot = FALSE,na.action = na.pass)[1,]
}
eval <- sapply(all_indices[,c(-1)], FUN=ac.1)[1,]
eval <- cbind(eval,apply(all_indices[,c(-1)],MARGIN=2, FUN=sd, na.rm=TRUE))
annualReturn(ts.all_indices, type='arithmetic')
install.packages(quantmod)
install.packages("quantmod")
library(quantmod)
annualReturn(ts.all_indices, type='arithmetic')
ac.1 <- function(x) {
acf(x,lag.max = 1,plot = FALSE,na.action = na.pass)[1,]
}
eval <- sapply(ts.all_indices[,c(-1)], FUN=ac.1)[1,]
eval <- cbind(eval,apply(ts.all_indices[,c(-1)],MARGIN=2, FUN=sd, na.rm=TRUE))
eval <- sapply(ts.all_indices[,c(-1)], FUN=ac.1)[1,]
acf(ts.all_indices,lag.max = 1,plot = FALSE,na.action = na.pass)[1,]
acf(ts.all_indices,lag.max = 1,plot = FALSE,na.action = na.pass)
acf(ts.all_indices,lag.max = 1,plot = FALSE,na.action = na.pass)[2,]
acf(ts.all_indices,lag.max = 1,plot = FALSE,na.action = na.pass)[1,]
acf(ts.all_indices,lag.max = 1,plot = FALSE,na.action = na.pass)[,2]
acf(ts.all_indices,lag.max = 1,plot = FALSE,na.action = na.pass)[,1]
eval <- sapply(ts.all_indices[,c(-1)], FUN=ac.1)[2,]
eval <- sapply(ts.all_indices[,c(-1)], FUN=ac.1)[1,]
eval <- sapply(ts.all_indices[,c(-1)], FUN=ac.1)[3,]
?afc
?acf
eval <- sapply(ts.all_indices[,c(-1)], FUN=ac.1)$acf
eval <- sapply(ts.all_indices[,c(-1)], FUN=ac.1)
View(eval)
acf(ts.all_indices,lag.max = 1,plot = FALSE,na.action = na.pass)$acf
eval <- sapply(ts.all_indices, FUN=ac.1)
ac.1 <- function(x) {
acf(x,lag.max = 1,plot = FALSE,na.action = na.pass)[1,1]
}
eval <- sapply(ts.all_indices, FUN=ac.1)
acf(ts.all_indices,lag.max = 1,plot = FALSE,na.action = na.pass)[1,1]
apply(ts.all_indices,MARGIN=2, FUN=sd, na.rm=TRUE)
apply(ts.all_indices,MARGIN=2, FUN=ac.1, na.rm=TRUE)
apply(ts.all_indices,MARGIN=2, FUN=ac.1)
sapply(ts.all_indices,MARGIN=2, FUN=ac.1)
apply(ts.all_indices,MARGIN=2, FUN=acf)
annualReturn(ts.all_indices, type='arithmetic')
annualReturn(ts.all_indices[,2], type='arithmetic')
sapply(ts.all_indices, FUN=annualReturn(ts.all_indices, type='arithmetic'))
returns <- data.frame()
for(i in 1:ncol(ts.all_indices)) {
returns <- cbind(returns, annualReturn(ts.all_indices, type='arithmetic'))
}
View(returns)
returns <- data.frame()
for(i in 1:ncol(ts.all_indices)) {
returns <- cbind(returns, annualReturn(ts.all_indices[,i], type='arithmetic'))
}
colnames(returns) <- colnames(ts.all_indices)
cor(returns)
dl.indices <- diff(log(ts.all_indices))
dl.indices <- as.data.frame(diff(log(ts.all_indices)))
View(dl.indices)
cor(dl.indices)
cor(dl.indices, use ="complete.obs")
apply(ts.all_indices,MARGIN=2, FUN=sd, na.rm=TRUE)
ac.1 <- function(x) {
acf(x,lag.max = 1,plot = FALSE,na.action = na.pass)[1,1]
}
eval <- sapply(ts.all_indices, FUN=ac.1)
View(eval)
ac.1 <- function(x) {
acf(x,lag.max = 1,plot = FALSE,na.action = na.pass)
}
sapply(ts.all_indices, FUN=ac.1)
eval <- apply(ts.all_indices, FUN=ac.1)
eval <- apply(ts.all_indices, MARGIN=2,FUN=ac.1)
eval$index_all
eval$index_all[,2]
eval$index_all[2]
eval$index_all[1]
eval[1[1]
}
eval[1][1]
eval[[1]][1]
eval[[1]]
for(i in 1:ncol(ts.all_indices)) {
ac1 <- eval[[i]][1]
}
eval <- apply(ts.all_indices, MARGIN=2,FUN=ac.1)[[1]][1]
eval <- apply(ts.all_indices, MARGIN=2,FUN=ac.1)[1]
eval <- apply(ts.all_indices, MARGIN=2,FUN=ac.1)
ac1
for(i in 1:ncol(ts.all_indices)) {
ac1 <- eval[[i]][1]
}
ac1 <- eval[1]
ac1
ac1 <- acf(ts.all_indices,lag.max = 1,plot = FALSE,na.action = na.pass)
ac1
ac1$acf
ac1$acf[1,1]
ac1$acf[1][1,1]
ac1$acf[, , 1]
ac1$acf[, , 1][1]
ac1$acf[, , 1][2]
ac1$acf[, , 8][2]
ac1$acf[, , 8][2,8]
eval <- acf(ts.all_indices,lag.max = 1,plot = FALSE,na.action = na.pass)
for(i in 1:ncol(ts.all_indices)) {
ac1 <- eval[, , i][2,i]
}
for(i in 1:ncol(ts.all_indices)) {
ac1 <- eval$acf[, , i][2,i]
}
for(i in 1:ncol(ts.all_indices)) {
ac1[i] <- eval$acf[, , i][2,i]
}
ac1 <- as.data.frame(ac1)
View(ac1)
acf(ts.all_indices[,1],lag.max = 1,plot = FALSE,na.action = na.pass)
acf(ts.all_indices[,2],lag.max = 1,plot = FALSE,na.action = na.pass)
acf(ts.all_indices[,3],lag.max = 1,plot = FALSE,na.action = na.pass)
acf(ts.all_indices[,4],lag.max = 1,plot = FALSE,na.action = na.pass)
acf(ts.all_indices[,5],lag.max = 1,plot = FALSE,na.action = na.pass)
acf(ts.all_indices[,5],lag.max = 3,plot = FALSE,na.action = na.pass)
acf(ts.all_indices[,6],lag.max = 4,plot = FALSE,na.action = na.pass)
